spring:
  application:
    name: albunyaan-tube
  # BACKEND-PERF-01: Cache configuration
  # Using Caffeine (in-memory) for dev, can switch to Redis for prod
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=1000,expireAfterWrite=3600s
    cache-names:
      - newpipeChannelInfo
      - newpipePlaylistInfo
      - newpipeVideoInfo
      - newpipeStreamUrls
      - newpipeSearchResults
      - newpipeChannelValidation
      - newpipePlaylistValidation
      - newpipeVideoValidation
      - categoryNameMapping
#    # Uncomment below for Redis in production
#    type: redis
#    redis:
#      time-to-live: 3600000 # 1 hour default TTL in milliseconds
#  data:
#    redis:
#      host: ${REDIS_HOST:localhost}
#      port: ${REDIS_PORT:6379}
#      password: ${REDIS_PASSWORD:}
#      lettuce:
#        pool:
#          max-active: 10
#          max-idle: 5
#          min-idle: 1
  # Gzip compression for responses
  compression:
    enabled: true
    mime-types: application/json,application/xml,text/html,text/xml,text/plain
    min-response-size: 1024
  # Task scheduling configuration
  task:
    scheduling:
      pool:
        size: 3 # Thread pool size for scheduled tasks
      thread-name-prefix: scheduled-task-
server:
  port: 8080
  compression:
    enabled: true
management:
  endpoints:
    web:
      exposure:
        # Limit exposed endpoints for security (httptrace removed - obsolete in Boot 3)
        # All endpoints now require ADMIN role (see SecurityConfig)
        include: health,info,metrics,prometheus,caches
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized
      show-components: when-authorized
    metrics:
      enabled: true
  metrics:
    export:
      prometheus:
        enabled: true
    distribution:
      percentiles-histogram:
        http.server.requests: true
      percentiles:
        http.server.requests: 0.5, 0.95, 0.99
      sla:
        http.server.requests: 200ms, 500ms, 1s, 2s
    tags:
      application: ${spring.application.name}
      environment: ${ENVIRONMENT:dev}
    enable:
      jvm: true
      process: true
      system: true
      tomcat: true
      cache: true
app:
  firebase:
    # Path to Firebase service account JSON (set via environment variable in production)
    service-account-path: ${FIREBASE_SERVICE_ACCOUNT_PATH:classpath:firebase-service-account.json}
    project-id: ${FIREBASE_PROJECT_ID:albunyaan-tube}
    # Firestore settings
    firestore:
      database-id: ${FIRESTORE_DATABASE_ID:(default)}
      # Operation-specific timeouts (in seconds)
      timeout:
        read: ${FIRESTORE_READ_TIMEOUT:5}           # Single document reads
        write: ${FIRESTORE_WRITE_TIMEOUT:10}        # Document writes/updates
        bulk-query: ${FIRESTORE_BULK_QUERY_TIMEOUT:30}  # Collection queries, findAll, search
      # Default maximum results for unbounded queries
      default-max-results: ${FIRESTORE_DEFAULT_MAX_RESULTS:1000}
  newpipe:
    # NewPipeExtractor configuration (no API key required)
    # Cache TTL for stream URLs (30 minutes, similar to Android implementation)
    stream-cache-ttl-minutes: 30
    # HTTP client settings
    http:
      connect-timeout-seconds: 30
      read-timeout-seconds: 30
      # User agent for NewPipe requests
      user-agent: "Mozilla/5.0 (Windows NT 10.0; rv:91.0) Gecko/20100101 Firefox/91.0"
  security:
    cors:
      allowed-origins: "http://localhost:5173,http://127.0.0.1:5173"
    initial-admin:
      email: admin@albunyaan.tube
      password: ChangeMe!123
      display-name: Initial Admin
download:
  token:
    # SECURITY: Secret key for generating download tokens
    # Set via environment variable in production: DOWNLOAD_TOKEN_SECRET_KEY
    # NEVER commit production secrets to version control
    secret-key: ${DOWNLOAD_TOKEN_SECRET_KEY:albunyaan-download-secret-key-change-in-production}

